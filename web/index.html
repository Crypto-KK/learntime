<!DOCTYPE html>
<!--
* CoreUI - Free Bootstrap Admin Template
* @version v2.0.0
* @link https://coreui.io
* Copyright (c) 2018 creativeLabs Łukasz Holeczek
* Licensed under MIT (https://coreui.io/license)
-->

<html lang="en">

<head>
  <base href="./">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta name="description" content="CoreUI - Open Source Bootstrap Admin Template">
  <meta name="author" content="Łukasz Holeczek">
  <meta name="keyword" content="Bootstrap,Admin,Template,Open,Source,jQuery,CSS,HTML,RWD,Dashboard">
  <title>活动记录</title>

  <link href="css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/css/bootstrap.min.css">
  <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdn.staticfile.org/popper.js/1.12.5/umd/popper.min.js"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue"></script>

  <link href="css/style.css" rel="stylesheet">
  <link href="css/index.css" rel="stylesheet">
  <style>
    [v-cloak] {
      display: none;
    }
  </style>
</head>

<body class="app header-fixed text-size-all" style="background-color: white;">
  <header id="globalHeader" class="app-header navbar"></header>
  <div style="margin-top: 55px;padding: 25px;" id="studentApp">
    <h4><b>详细信息</b></h4>
    <table class="table table-responsive-sm" style="width: 80%;margin-top: 15px;">
      <thead>
        <tr>
          <th>学号</th>
          <th>姓名</th>
          <th>学院</th>
          <th>班级</th>
          <th>总学时</th>
          <th>创新创业</th>
          <th>思想品德</th>
          <th>法律</th>
          <th>文体</th>
          <th>身心</th>
        </tr>
      </thead>
      <tbody>
        <tr v-cloak>
          <td>{{uid}}</td>
          <td>{{name}}</td>
          <td>{{academy}}</td>
          <td>{{clazz}}</td>
          <td>{{credit}}</td>
          <td>{{cxcy_credit}}</td>
          <td>{{xl_credit}}</td>
          <td>{{fl_credit}}</td>
          <td>{{wt_credit}}</td>
          <td>{{sxdd_credit}}</td>
        </tr>
      </tbody>
    </table>
    <h4 style="margin-top: 40px;"><b>查看活动参加记录</b></h4>
    <div>
      <ul class="nav nav-tabs" v-cloak>
        <li class="nav-item">
          <a class="nav-link studentt active" href="javascript:void(0)"
            v-on:click="activityType(allType)">{{allType}}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link studentt" href="javascript:void(0)" v-on:click="activityType(cycxTYpe)">{{cycxTYpe}}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link studentt" href="javascript:void(0)" v-on:click="activityType(sxpdType)">{{sxpdType}}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link studentt" href="javascript:void(0)" v-on:click="activityType(flType)">{{flType}}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link studentt" href="javascript:void(0)" v-on:click="activityType(wtType)">{{wtType}}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link studentt" href="javascript:void(0)" v-on:click="activityType(sxType)">{{sxType}}</a>
        </li>
      </ul>
      <table class="table table-responsive-sm table-bordered table-striped table-hover">
        <thead>
          <tr>
            <th>姓名</th>
            <th>参与活动名</th>
            <th>参与身份</th>
            <th>获得学时</th>
            <th>类别</th>
            <th>状态</th>
            <th>时间</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="item in activation_record" v-cloak>
            <td>{{ name }}</td>
            <td>{{ item.activity_name }}</td>
            <td>{{ item.join_type }}</td>
            <td>{{ item.credit }}</td>
            <td>{{ item.credit_type }}</td>
            <td>{{ item.status }}</td>
            <td>{{ item.create_time }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script src="js/student.js"></script>
  <script src="js/header.js"></script>
  <script src="js/config.js"></script>
  <script>
    $.ajax({
      url: STUDENT_RECORDS,
      type: 'get',
      dataType: "JSON",
      headers: {
        'Content-Type': "application/json",
        Authorization: "JWT " + studentData.token,
      },
      success: function (res) {
        let storage = window.sessionStorage;
        let objStr = JSON.stringify(res);
        storage.setItem('activation_record', objStr);
       
        let example = new Vue({
          el: "#studentApp",
          data: {
            academy: studentData.academy,
            clazz: studentData.clazz,
            credit: studentData.credit.toFixed(1),
            cxcy_credit: studentData.cxcy_credit.toFixed(1),
            fl_credit: studentData.fl_credit.toFixed(1),
            grade: studentData.grade,
            name: studentData.name,
            sxdd_credit: studentData.sxdd_credit.toFixed(1),
            uid: studentData.uid,
            wt_credit: studentData.wt_credit.toFixed(1),
            xl_credit: studentData.xl_credit.toFixed(1),
            activation_record: res,
            allType: '全部参加记录',
            cycxTYpe: '创新创业素质',
            sxpdType: '思想品德素质',
            flType: '法律素养',
            wtType: '文体素质',
            sxType: '身心素质'
          },
          methods: {
            activityType: function (type) {
              let I = ['全部参加记录', '创新创业素质', '思想品德素质', '法律素养', '文体素质', '身心素质'].indexOf(type);
              let $oldActive = $('.active');
              $oldActive.removeClass('active');
              let $newActive = $('.studentt')[I];
              $newActive.classList.add('active');
              this.activation_record = type_method(type);
            }
          }
        })
      }, error: function (result) {
        if (401 == result.status) {
          window.location.replace("login.html");
        }
      }
    })

  </script>
</body>

</html>